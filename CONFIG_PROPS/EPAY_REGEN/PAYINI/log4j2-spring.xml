<?xml version="1.0" encoding="UTF-8"?>
<!-- No 'packages' attribute (deprecated) -->
<Configuration status="WARN" monitorInterval="10">
  <Properties>
    <Property name="APP_NAME">EpayIniRegenerator</Property>

    <!-- Avoid name collision/recursion: use APP_LOG_DIR, not LOG_DIR -->
    <!-- Order: Spring property -> ENV -> SYS -> default "logs" -->
    <Property name="APP_LOG_DIR">C:/PFMS_MIG/LOGS</Property>
    <Property name="APP_LOG_FILE">${APP_LOG_DIR}/${APP_NAME}.log</Property>
    <Property name="CONSOLE_PATTERN">%d{HH:mm:ss.SSS} %-5p [%t] %X{requestId} %X{msgId} %X{batch} %logger{36} - %msg%n%throwable</Property>
    <Property name="FILE_PATTERN">%d{yyyy-MM-dd HH:mm:ss.SSS} %-5p [%t] %X{requestId} %X{msgId} %X{batch} %logger{36} - %msg%n%throwable</Property>
  </Properties>

  <Appenders>
    <Console name="Console">
      <PatternLayout pattern="${CONSOLE_PATTERN}"/>
    </Console>

    <RollingRandomAccessFile name="File"
        fileName="${APP_LOG_FILE}"
        filePattern="${APP_LOG_DIR}/${APP_NAME}-%d{yyyy-MM-dd}-%i.log.gz">
      <PatternLayout pattern="${FILE_PATTERN}"/>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
        <SizeBasedTriggeringPolicy size="50 MB"/>
      </Policies>
      <DefaultRolloverStrategy max="20"/>
    </RollingRandomAccessFile>
  </Appenders>

  <!-- Use AsyncLogger only if Disruptor is on classpath (we added it) -->
  <Loggers>
    <AsyncLogger name="com.intech.EpayIniFileGenerator" level="debug" additivity="false">
      <AppenderRef ref="Console"/>
      <AppenderRef ref="File"/>
    </AsyncLogger>

    <AsyncLogger name="org.hibernate.SQL" level="debug" additivity="false">
      <AppenderRef ref="Console"/>
      <AppenderRef ref="File"/>
    </AsyncLogger>
    <AsyncLogger name="org.hibernate.orm.jdbc.bind" level="trace" additivity="false">
      <AppenderRef ref="File"/>
    </AsyncLogger>
    <AsyncLogger name="org.hibernate.type.descriptor.sql" level="trace" additivity="false">
      <AppenderRef ref="File"/>
    </AsyncLogger>

    <Root level="info">
      <AppenderRef ref="Console"/>
      <AppenderRef ref="File"/>
    </Root>
  </Loggers>
</Configuration>
