# Step 1: accounts selection
ACCT_SELECT=SELECT DISTINCT ACCT_NO FROM TXN_ACCOUNT_STATUS WHERE DATA_REQ_FLAG = 'Y'

# Step 2: Account attributes (named parameters)
BAL=SELECT gam.foracid, SUBSTR(sol.UNIFORM_BR_CODE,1,7) AS BSRCODE, TO_CHAR(TO_DATE(:txndate,'ddmmyyyy'),'dd/MM/yyyy') AS closedate, gam.OPENING_BAL AS openingbal, gam.CLOSING_BAL AS closingbal FROM gam JOIN sol ON gam.sol_id = sol.sol_id WHERE gam.foracid = :foracid

# Step 3: Txn count (positional parameters)
CNT=select max(ctr) from (select count(*) ctr from gam g, htd d where g.acid=d.acid and d.TRAN_DATE=to_date(?,'ddmmyyyy') and d.DEL_FLG<>'Y' and d.PSTD_FLG='Y' and g.FORACID=?)

# Step 4: Txn details (positional parameters)
TXN=select to_char(d.tran_date,'dd-mon-yyyy') tran_date, d.part_tran_type part_tran_type, d.TRAN_SUB_TYPE tran_sub_type, NVL(replace(d.TRAN_PARTICULAR, '''', ''),'xxxxxxxx') tran_particular, NVL(d.INSTRMNT_NUM,'NA') instrmnt_num, NVL(to_char(d.INSTRMNT_DATE,'dd/MM/yyyy'),'NA') instrmnt_date, d.TRAN_AMT tran_amt, NVL(d.TRAN_RMKS,'NA') tran_rmks, d.TRAN_ID tran_id, trim(d.part_tran_srl_num) part_tran_srl_num, NVL(d.TRAN_PARTICULAR_2,'NA') tran_particular_2, to_char(d.VALUE_DATE,'dd/MM/yyyy') value_date from gam g, htd d where d.acid=g.acid and d.TRAN_DATE = to_date(?,'ddmmyyyy') and d.DEL_FLG='N' and d.PSTD_FLG='Y' and g.FORACID=?
